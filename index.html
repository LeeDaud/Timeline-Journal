<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="极简时间轴日记">
  <title>时间轴日记</title>

  <!-- Favicon 图标 -->
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#0f1214">

  <!-- CSS -->
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/layout.css">
  <link rel="stylesheet" href="css/components.css">
</head>
<body>

  <!-- 顶部导航栏 -->
  <header class="app-header">
    <div class="header-container">
      <h1 class="app-title">时间轴日记</h1>
      <div class="header-actions">
        <button class="btn-mode-toggle" id="btnModeToggle" aria-label="切换模式">
          <span class="mode-toggle-text" data-diary="日记" data-review="回顾">日记</span>
        </button>
        <button class="btn-theme-toggle" id="btnThemeToggle" aria-label="切换主题" title="切换日间/夜间模式">
          <span class="theme-text">自动</span>
        </button>
        <!-- 移除旧的新建按钮，改用下方的写作入口 -->
      </div>
    </div>
  </header>

  <!-- 时间锚点 -->
  <div class="time-anchor" id="timeAnchor">
    <div class="time-anchor-container">
      <div class="time-anchor-year">2024</div>
      <div class="time-anchor-primary">
        <span class="time-anchor-month">12</span>
        <span class="time-anchor-separator">月</span>
        <span class="time-anchor-day">16</span>
        <span class="time-anchor-separator">日</span>
      </div>
      <div class="time-anchor-weekday">周一</div>
    </div>
  </div>

  <!-- 主内容区域 -->
  <main class="app-main">
    <!-- 左侧生命日历 -->
    <aside class="life-calendar" id="lifeCalendar">
      <div class="life-calendar-header">
        <span class="calendar-title">生命日历</span>
        <!-- 展示范围信息条（可点击） -->
        <button class="calendar-range-btn" id="calendarRangeBtn" aria-label="修改展示范围">
          <span class="calendar-range-text" id="calendarRangeText">第 24～25 岁</span>
          <svg class="calendar-range-icon" viewBox="0 0 16 16" fill="none">
            <path d="M4 6l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>

      <!-- 星期头 -->
      <div class="calendar-weekday-header">
        <div class="week-number-cell"></div>
        <div class="weekday-cell">SUN</div>
        <div class="weekday-cell">MON</div>
        <div class="weekday-cell">TUE</div>
        <div class="weekday-cell">WED</div>
        <div class="weekday-cell">THU</div>
        <div class="weekday-cell">FRI</div>
        <div class="weekday-cell">SAT</div>
      </div>

      <div class="life-calendar-grid" id="lifeCalendarGrid">
        <!-- 日历矩阵将通过 JS 动态生成 -->
      </div>

      <!-- 底部跳转入口 -->
      <div class="calendar-jump-section">
        <button class="calendar-jump-btn" id="calendarJumpBtn" aria-label="跳转到某一天">
          <svg class="calendar-jump-icon" viewBox="0 0 20 20" fill="none">
            <rect x="3" y="4" width="14" height="13" rx="2" stroke="currentColor" stroke-width="1.2"/>
            <path d="M3 8h14" stroke="currentColor" stroke-width="1.2"/>
            <path d="M7 2v4M13 2v4" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
          </svg>
          <span class="calendar-jump-text">跳转到…</span>
        </button>
      </div>
    </aside>

    <!-- 右侧时间轴 -->
    <div class="timeline-wrapper">
      <div class="timeline-container" id="timelineContainer">

        <!-- 写作入口 - 简洁的书写空间 -->
        <div class="writing-entry" id="writingEntry">
          <!-- 目标日期指示器（非今天时显示） -->
          <div class="writing-entry-date-hint" id="writingEntryDateHint">
            <span class="date-hint-text"></span>
            <button class="date-hint-clear" id="dateHintClear" aria-label="清除目标日期">×</button>
          </div>
          <textarea
            class="writing-entry-input"
            id="writingEntryInput"
            placeholder="记录此刻…"
            rows="3"
            data-min-rows="3"
            data-max-rows="12"
          ></textarea>

          <!-- 底部栏：时间 + 天气 + 提交按钮 -->
          <div class="writing-entry-footer">
            <!-- 时间（可点击编辑） -->
            <button class="writing-entry-time-btn" id="writingEntryTimeBtn" aria-label="修改时间">
              <span class="writing-entry-time" id="writingEntryTime">--:--</span>
            </button>

            <!-- 天气选择（小图标） -->
            <button class="writing-entry-weather-btn" id="writingEntryWeatherBtn" aria-label="选择天气">
              <span class="weather-icon-mini" id="writingEntryWeatherIcon"></span>
            </button>

            <button class="writing-entry-submit" id="writingEntrySubmit" aria-label="保存">
              <!-- 自定义图标：assets/icons/icon.svg -->
              <img class="submit-icon-custom" src="assets/icons/icon.svg" alt="保存" onerror="this.style.display='none';this.nextElementSibling.style.display='block';">
              <!-- 备用图标（当自定义图标加载失败时显示）-->
              <svg class="submit-icon-fallback" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="display:none;">
                <path d="M5 13l4 4L19 7" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- 时间轴内容 -->
        <div id="timeline">
          <!-- 时间轴内容将通过 JS 动态渲染到这里 -->

          <!-- 空状态（初次使用时显示） -->
          <div class="empty-state" id="emptyState">
            <p class="empty-hint">开始记录</p>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- 编辑器（弹出层） -->
  <div class="editor-overlay" id="editorOverlay">
    <div class="editor-container">
      <div class="editor-header">
        <button class="btn-close" id="btnClose" aria-label="关闭">×</button>
        <span class="editor-time" id="editorTime">14:32</span>
      </div>
      <textarea
        class="editor-textarea"
        id="editorTextarea"
        placeholder="写点什么..."
        autofocus
      ></textarea>
      <div class="editor-footer">
        <button class="btn-delete" id="btnDelete">删除</button>
        <button class="btn-save" id="btnSave">保存</button>
      </div>
    </div>
  </div>

  <!-- 移除底部浮动按钮，改用顶部写作入口 -->

  <!-- JavaScript -->
  <script src="js/theme.js"></script>
  <script src="js/storage.js"></script>
  <script src="js/models.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/writing-entry.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
